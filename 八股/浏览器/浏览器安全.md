## 浏览器安全相关面试题

**Q: 什么是 CSRF，如何防御？**  
A: CSRF（跨站请求伪造）是一种攻击方式，攻击者诱导已登录用户在不知情的情况下发起非本意的请求，导致后台执行敏感操作。例如：用户登录银行网站后未登出，攻击者在论坛发帖中插入一张指向转账接口的图片，当用户浏览帖子时即发起转账。常见防御措施包括：

1. **使用 CSRF Token**：每次请求时，服务端生成随机 Token，前端需随表单或请求一同提交，服务端校验 Token 是否有效。
2. **校验 Referer/Origin 请求头**：仅允许来自本站的请求。
3. **设置 Cookie 的 SameSite 属性**：防止第三方网站携带 Cookie 发起请求。
4. **关键操作增加二次验证**：如验证码、短信验证等，防止自动化滥用。
5. **限制请求方式**：如对敏感操作仅允许 POST/PUT，不允许 GET。

**Q: 什么是 XSS，如何防御？**  
A: XSS（跨站脚本攻击）是指攻击者将恶意脚本注入网页，当用户访问时在其浏览器端执行。主要类型有：

- **存储型 XSS**：恶意脚本被存入数据库，所有访问页面的用户都会中招。
- **反射型 XSS**：恶意代码通过 URL 参数传递，用户点击带恶意参数的链接时触发。
- **DOM 型 XSS**：前端 JS 处理数据时未正确过滤，直接操作 DOM 导致注入。  
  危害：窃取 Cookie、伪造操作、钓鱼、传播蠕虫。防御方法：

1. **输出内容转义**：对 HTML、JS、CSS、URL 输出做转义，防止脚本执行。
2. **使用 CSP（Content Security Policy）**：限制可执行脚本来源，阻止内联脚本。
3. **HttpOnly Cookie**：设置 Cookie 为 HttpOnly，防止被 JS 读取。
4. **输入校验和过滤**：对用户输入进行白名单校验，禁止危险标签和属性。
5. **前后端联合防护**：前端过滤、后端二次校验，避免单点失守。

**Q: 网络劫持和中间人攻击的区别？如何防御？**  
A:

- **网络劫持**：通常发生在运营商、路由器或本地恶意软件层面，表现为插入广告、劫持 DNS、篡改页面内容等。例如：公共 Wi-Fi 强插广告、家庭路由器被劫持。
- **中间人攻击（MITM）**：攻击者在客户端与服务器之间拦截、篡改、伪造数据。常见于公共 Wi-Fi、DNS 劫持、ARP 欺骗等。  
  防御措施：
- **全站强制使用 HTTPS**，防止明文传输被篡改。
- **校验证书合法性**，防止信任伪造证书。
- **对关键接口使用数字签名**，校验数据完整性和来源。
- **避免信任不安全网络**，如不随意连接公共 Wi-Fi。

**Q: Token 应该存放在哪里更安全？**  
A: Token 存储位置需权衡安全性与易用性：

- **LocalStorage**：易被 XSS 攻击窃取，不推荐用于存储敏感 Token（如 JWT）。
- **SessionStorage**：生命周期随标签页关闭，但同样受 XSS 威胁。
- **HttpOnly Cookie**：推荐，设置 HttpOnly 属性后 JS 无法访问，结合 Secure（仅 HTTPS 传输）、SameSite（防 CSRF）进一步提升安全。适合存储认证 Token。
- **内存存储**：Token 仅存于 JS 变量中，页面刷新即丢失，适合短期 Token，结合刷新机制减少被窃风险。
