# 网络模型层

## 1. OSI 七层模型

### 1.1 物理层（Physical Layer）
- **功能**：在物理媒体上传输原始比特流
- **协议**：以太网、WiFi、蓝牙
- **设备**：网卡、集线器、中继器
- **数据单位**：比特（bit）

### 1.2 数据链路层（Data Link Layer）
- **功能**：将比特流组织成帧，进行差错检测和流量控制
- **协议**：PPP、HDLC、以太网
- **设备**：网桥、交换机
- **数据单位**：帧（Frame）
- **主要功能**：
  - 帧同步
  - 差错控制
  - 流量控制
  - MAC 地址寻址

### 1.3 网络层（Network Layer）
- **功能**：负责数据包的路由选择和转发
- **协议**：IP、ICMP、ARP、RARP
- **设备**：路由器
- **数据单位**：数据包（Packet）
- **主要功能**：
  - 路由选择
  - 拥塞控制
  - 网络互连

### 1.4 传输层（Transport Layer）
- **功能**：提供端到端的可靠数据传输服务
- **协议**：TCP、UDP
- **数据单位**：段（Segment）
- **主要功能**：
  - 可靠传输
  - 流量控制
  - 拥塞控制
  - 端口复用

### 1.5 会话层（Session Layer）
- **功能**：建立、管理和终止会话
- **协议**：RPC、SQL、NetBIOS
- **主要功能**：
  - 会话建立
  - 会话管理
  - 会话同步

### 1.6 表示层（Presentation Layer）
- **功能**：数据格式转换、加密解密
- **协议**：SSL/TLS、JPEG、ASCII
- **主要功能**：
  - 数据格式转换
  - 数据加密解密
  - 数据压缩

### 1.7 应用层（Application Layer）
- **功能**：为用户提供网络服务
- **协议**：HTTP、HTTPS、FTP、SMTP、DNS
- **主要功能**：
  - 文件传输
  - 电子邮件
  - 万维网服务

## 2. TCP/IP 四层模型

### 2.1 网络接口层（Network Interface Layer）
- **对应 OSI**：物理层 + 数据链路层
- **功能**：处理物理网络连接
- **协议**：以太网、WiFi、PPP

### 2.2 网络层（Internet Layer）
- **对应 OSI**：网络层
- **功能**：负责数据包的路由
- **核心协议**：IP
- **辅助协议**：
  - ICMP：网络控制消息
  - ARP：地址解析协议
  - RARP：反向地址解析

### 2.3 传输层（Transport Layer）
- **对应 OSI**：传输层
- **功能**：提供端到端通信
- **协议**：
  - TCP：面向连接，可靠传输
  - UDP：无连接，不可靠传输

### 2.4 应用层（Application Layer）
- **对应 OSI**：会话层 + 表示层 + 应用层
- **功能**：提供各种网络应用服务
- **协议**：
  - HTTP/HTTPS：超文本传输协议
  - FTP：文件传输协议
  - SMTP：简单邮件传输协议
  - DNS：域名系统
  - SSH：安全外壳协议

## 3. 两种模型的对比

| 特性 | OSI 七层模型 | TCP/IP 四层模型 |
|------|-------------|----------------|
| 层次数 | 7层 | 4层 |
| 设计理念 | 理论模型 | 实际应用模型 |
| 标准化 | 国际标准化组织 | 互联网工程任务组 |
| 应用范围 | 理论指导 | 实际网络协议 |

## 4. 数据封装过程

### 4.1 发送数据时的封装
1. **应用层**：生成应用数据
2. **传输层**：添加 TCP/UDP 头部
3. **网络层**：添加 IP 头部
4. **数据链路层**：添加帧头部和尾部
5. **物理层**：转换为比特流

### 4.2 接收数据时的解封装
1. **物理层**：接收比特流
2. **数据链路层**：去除帧头部和尾部
3. **网络层**：去除 IP 头部
4. **传输层**：去除 TCP/UDP 头部
5. **应用层**：获取应用数据

## 5. 常见协议详解

### 5.1 HTTP/HTTPS
- **端口**：HTTP 80，HTTPS 443
- **特点**：无状态、请求-响应模式
- **方法**：GET、POST、PUT、DELETE 等
- **状态码**：1xx、2xx、3xx、4xx、5xx

### 5.2 TCP
- **特点**：面向连接、可靠传输
- **三次握手**：建立连接
- **四次挥手**：断开连接
- **流量控制**：滑动窗口机制
- **拥塞控制**：慢启动、拥塞避免、快重传、快恢复

### 5.3 UDP
- **特点**：无连接、不可靠传输
- **应用场景**：实时通信、流媒体
- **优点**：延迟低、开销小
- **缺点**：不保证数据完整性

### 5.4 DNS
- **功能**：域名解析
- **查询过程**：递归查询、迭代查询
- **记录类型**：A、AAAA、CNAME、MX、NS 等

## 6. 网络设备

### 6.1 集线器（Hub）
- **工作层次**：物理层
- **功能**：信号放大和转发
- **特点**：广播式传输，冲突域大

### 6.2 交换机（Switch）
- **工作层次**：数据链路层
- **功能**：根据 MAC 地址转发数据
- **特点**：智能转发，减少冲突域

### 6.3 路由器（Router）
- **工作层次**：网络层
- **功能**：根据 IP 地址路由数据包
- **特点**：连接不同网络，隔离广播域

### 6.4 网关（Gateway）
- **工作层次**：应用层
- **功能**：协议转换
- **特点**：连接不同协议的网络

## 7. 网络安全

### 7.1 常见攻击
- **DDoS**：分布式拒绝服务攻击
- **中间人攻击**：数据窃听和篡改
- **ARP 欺骗**：MAC 地址欺骗

### 7.2 防护措施
- **防火墙**：网络访问控制
- **VPN**：虚拟专用网络
- **SSL/TLS**：传输层安全
- **WAF**：Web 应用防火墙

## 8. 性能优化

### 8.1 网络优化
- **CDN**：内容分发网络
- **负载均衡**：分散服务器压力
- **缓存策略**：减少重复请求

### 8.2 协议优化
- **HTTP/2**：多路复用、头部压缩
- **HTTP/3**：基于 QUIC 协议
- **WebSocket**：全双工通信

## 9. 实际应用场景

### 9.1 Web 开发
- **前端**：HTTP/HTTPS 协议
- **后端**：TCP 连接池
- **数据库**：TCP 连接

### 9.2 移动应用
- **API 调用**：HTTP/HTTPS
- **推送通知**：WebSocket
- **文件上传**：FTP/SFTP

### 9.3 物联网
- **MQTT**：轻量级消息传输
- **CoAP**：受限应用协议
- **LoRaWAN**：低功耗广域网
